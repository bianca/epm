<% if can? :calendar, Event %>
  <p><strong><%= link_to 'Monthly Calendar', calendar_events_path %></strong></p>
<% end %>

<% if can? :create, Event %>
  <p><strong><%= link_to 'Add New Event', new_event_path %></strong></p>
<% end %>

<% events_shown = false %>

<% if defined?(@awaiting_approval) && @awaiting_approval.any? %>
  <% events_shown = true %>
  <div>
    <h2>Events Awaiting Approval</h2>
      <%= render 'events', events: @awaiting_approval %>
  </div>
<% end %>

<% if defined?(@missing_parts) && @missing_parts.any? %>
  <% events_shown = true %>
  <div>
    <h2><%= @missing_title %></h2>
      <%= render 'events', events: @missing_parts %>
  </div>
<% end %>

<% if current_user.events.not_past.any? %>
  <% events_shown = true %>
  <div>
    <h2>My Upcoming Events</h2>
    <%= render 'events', events: current_user.events.not_past %>
  </div>
<% end %>

<% if @joinable.any? %>
  <div id="upcoming">
    <h2><%= 'More ' if events_shown %>Upcoming Events</h2>
    <% events_shown = true %>
    <%= render 'events', events: @joinable %>
  </div>
<% end %>

<% unless events_shown %>
  <% if Event.past.any? %>
    <div>
      <h2>Past Events</h2>
      <%= render 'events', events: Event.past.limit(10) %>
    </div>
  <% else %>
    <p>There are no events yet.</p>
  <% end %>
<% end %>