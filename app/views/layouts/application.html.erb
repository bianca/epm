<!DOCTYPE html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Event-Participant Manager<%= ": #{yield :title}" if content_for :title %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <%= stylesheet_link_tag    "application", media: "all", "data-turbolinks-track" => true %>
  <%= javascript_include_tag "application", "data-turbolinks-track" => true %>
  <%= csrf_meta_tags %>
</head>
<body>

  <header>
    <% if user_signed_in? %>
      <h1><%= link_to 'EPM', root_path, title: 'Event-Participant Manager' %></h1>
      <nav>
        <ul>
          <li<%= ' class="active"'.html_safe if controller_name == 'events' %>><%= link_to 'Events', root_path %></li>
          <% on_profile = controller_name == 'users' && params['id'].to_i == current_user.id %>
          <% if can? :index, User %>
              <li<%= ' class="active"'.html_safe if controller_name == 'users' && !on_profile %>><%= link_to 'Users', users_path %></li>
          <% end %>
          <li<%= ' class="active"'.html_safe if on_profile %>><%= link_to 'My Profile', current_user %></li>
        </ul>
        <%= link_to 'Log out', destroy_user_session_path, id: 'account' %>
      </nav>
    <% else %>
      <h1>Event-Participant Manager</h1>
    <% end %>
    <%= clear %>
  </header>

  <% flash.each do |name, msg| -%>
    <%= content_tag :div, msg, class: name, id: 'flash' %>
  <% end -%>

  <div id="main">
    <%= content_tag(:h1, yield(:title)) if content_for :title %>
    <%= yield %>
  </div>

</body>
</html>